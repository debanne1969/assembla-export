window.jQuery=window.jQueryLatest,function(e){"use strict";var t=e.NotificationCenterNamespace;t.MentionMixin={processSuccess:function(t){var n=e(ReactDOM.findDOMNode(this));this.props.inDropdown&&n.css("height",0),setTimeout(function(){this.isMounted()&&this.setState({read:!0})}.bind(this),1e3)},processFailure:function(){this.errorMessage("Unable to mark mention as read")},markAsRead:function(n){e.helpers.handleEvent(n),t.NotificationCenterManager.markMentionAsRead(this.props.id).done(this.processSuccess).fail(this.processFailure)}}}(jQuery),function(e){"use strict";var t=e.NotificationCenterNamespace;t.MentionsContainerMixin={processSuccess:function(){this.props.onMarkMentionsAsRead()},processFailure:function(){this.errorMessage("Failed to mark mentions as read")},markAllMentionsAsRead:function(n){e.helpers.handleEvent(n),t.NotificationCenterManager.markAllMentionsAsRead().done(this.processSuccess).fail(this.processFailure)}}}(jQuery);var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};(function(e){"use strict";var t=e.NotificationCenterNamespace;t.NotificationCenterDataFlowMixin={componentDidMount:function(){this.fetchData();if(this.refs.counter){var n=e(ReactDOM.findDOMNode(this.refs.counter)),r=n.offset().left,i=e(window).width()-r-n.outerWidth();e(this.refs.triangle).css("right",i)}var s=t.NotificationCenterChannelActions;s.subscribe(s.ALL,this)},componentWillUnmount:function(){t.NotificationCenterChannelActions.unsubscribe()},fetchData:function(){this.fetchMentions(),this.props.isDropdown&&(this.fetchProductUpdates(),this.fetchNotifications())},reloadData:function(){this.fetchData()},loadMoreMentions:function(t){e.helpers.handleEvent(t),this.fetchMentions(!0)},fetchMentions:function(e){e=typeof e=="undefined"?!1:e;var n=this,r=function(){n.setState({mentionsLoaded:!0}),n.errorMessage("An error occurred while updating mentions")},i;this.props.forFullPage&&(i={fp:1},e&&(i.page=this.state.page+1)),t.NotificationCenterManager.loadMentions(i).done(this.updateMentions).fail(r)},fetchProductUpdates:function(){var e=this,n=function(){e.setState({productUpdatesLoaded:!0}),e.errorMessage("An error occurred while fetching product updates")};t.NotificationCenterManager.loadProductUpdates().done(this.updateProductUpdates).fail(n)},fetchNotifications:function(){var e=this,n=function(){e.setState({notificationsLoaded:!0}),e.errorMessage("An error occurred while updating alerts")};t.NotificationCenterManager.loadNotifications().done(this.updateNotifications).fail(n)},updateMentions:function(e){var t;this.props.forFullPage?t=this.mergeUnique(this.state.mentions,e.mentions):(t=this.mergeUnique(e.mentions,this.state.mentions),t=t.splice(0,5));var n={mentions:t,mentionsCount:e.mentions_count,mentionsLoaded:!0,showMentionsInfo:e.show_mentions_info};this.props.forFullPage&&(n.page=e.page,n.lastPage=e.last_page),this.setState(n)},updateProductUpdates:function(e){var t=this.mergeUnique(this.state.productUpdates,e.product_updates);this.setState({productUpdates:t,productUpdatesCount:e.product_updates_count,productUpdatesLoaded:!0})},updateNotifications:function(e){var t=this.mergeUnique(this.state.notifications,e.notifications);this.setState({notifications:t,notificationsCount:e.notifications_count,notificationsLoaded:!0})},toggleNotificationCenter:function(){this.setState({visible:!this.state.visible})},handleDocumentClick:function(t){this.props.isDropdown&&this.state.visible&&!e.contains(this.refs.dropdown,t.target)&&!e.contains(ReactDOM.findDOMNode(this.refs.counter),t.target)&&this.setState({visible:!1})},processMarkMentionsAsReadSuccess:function(){var t=e.extend(!0,[],this.state.mentions);_.each(t,function(e){e.is_read=!0}),this.setState({mentions:t,mentionsCount:0})},markMentionAsRead:function(t,n,r){var i={mentionsCount:r},s;if(this.props.forFullPage){s=e.extend(!0,[],this.state.mentions);var o=_.find(s,{id:t});o.is_read=!0}else s=_.reject(this.state.mentions,{id:t}),n&&!_.contains(s,n)&&s.push(n);i.mentions=s,this.setState(i)},processMarkProductUpdatesAsReadSuccess:function(){var t=e.extend(!0,[],this.state.productUpdates);_.each(t,function(e){e.isRead=!0}),this.setState({productUpdates:t,productUpdatesCount:0})},markProductUpdateAsRead:function(e){var t=_.reject(this.state.productUpdates,{id:e});this.setState({productUpdates:t,productUpdatesCount:t.length})},processMarkNotificationsAsReadSuccess:function(){var t=e.extend(!0,[],this.state.notifications);_.each(t,function(e){e.isRead=!0}),this.setState({notifications:t,notificationsCount:0})},markNotificationAsRead:function(e,t,n){var r=_.reject(this.state.notifications,{id:e}),i={notificationsCount:n};t&&!_.contains(r,t)&&r.push(t),i.notifications=r,this.setState(i)},processMarkAllFailure:function(){this.errorMessage("Failed to mark notifications as read")},markAllMentionsAsRead:function(){t.NotificationCenterManager.markAllMentionsAsRead().done(this.processMarkMentionsAsReadSuccess).fail(this.processMarkAllFailure)},markAllNotificationsAsRead:function(){t.NotificationCenterManager.markAllNotificationsAsRead().done(this.processMarkNotificationsAsReadSuccess).fail(this.processMarkAllFailure)},markAllProductUpdatesAsRead:function(){t.NotificationCenterManager.markAllProductUpdatesAsRead().done(this.processMarkProductUpdatesAsReadSuccess).fail(this.processMarkAllFailure)},addMention:function(t,n){if(_.contains(this.state.mentions,t)){this.setState({mentionsCount:n});return}var r=e.extend([],this.state.mentions,!0);r.unshift(t),this.props.forFullPage||(r=r.splice(0,5)),this.setState({mentions:r,mentionsCount:n})},updateMention:function(t,n){var r=e.extend([],this.state.mentions,!0),i=r.indexOf(t);if(i===-1){this.setState({mentionsCount:n});return}r[i]=t,this.setState({mentions:r,mentionsCount:n})},addNotification:function(t,n){if(_.contains(this.state.notifications,t)){this.setState({notificationsCount:n});return}var r=e.extend([],this.state.notifications,!0);r.unshift(t),this.setState({notifications:r,notificationsCount:n})},createNotificationItem:function(n){var r=e.helpers.camelizeProps(n);switch(n.notification_type){case"mention":return React.createElement(t.Mentions.Mention,_extends({key:n.id,inDropdown:this.props.isDropdown,inFullPage:this.props.forFullPage},r));case"notification":return React.createElement(t.Notifications.Notification,{key:n.id,type:n.type,inDropdown:this.props.isDropdown,onMarkNotificationAsRead:this.markNotificationAsRead,data:r});case"product_update":return React.createElement(t.ProductUpdates.ProductUpdate,_extends({key:n.id,inDropdown:this.props.isDropdown,onMarkProductUpdateAsRead:this.markProductUpdateAsRead},r))}},markAllAsRead:function(t){e.helpers.handleEvent(t),this.markAllMentionsAsRead(),this.markAllNotificationsAsRead(),this.markAllProductUpdatesAsRead()},isDataLoaded:function(){return this.state.mentionsLoaded&&this.state.notificationsLoaded&&this.state.productUpdatesLoaded},overallCount:function(){return this.state.mentionsCount+this.state.notificationsCount+this.state.productUpdatesCount},mergeUnique:function(){return _.uniq(_.flatten(arguments,!0),!1,_.property("id"))}}})(jQuery),function(e){"use strict";var t=e.NotificationCenterNamespace;t.NotificationMixin={componentDidUpdate:function(t,n){if(!this.props.inDropdown)return;var r=e(ReactDOM.findDOMNode(this)),i=r.outerHeight();i>0&&r.css("height",r.outerHeight())},componentWillReceiveProps:function(e){!this.state.isRead&&e.isRead&&this.setState({isRead:!0})},markAsReadElement:function(){return React.createElement("span",{className:"notificationsDropdown-readToggle cursor-pointer",title:"Mark as read",onClick:this.markAsRead,"aria-hidden":"true"})},goToLink:function(t){if(t.ctrlKey||t.metaKey||this.isMiddleClick(t)){this.props.inDropdown&&this.setHeight(t);return}if(!this.props.hasOwnProperty("link"))return;e.helpers.handleEvent(t),this.props.inDropdown&&this.setHeight(t),e.helpers.redirectTo(this.props.link)},notificationWrapper:function(){if(this.state.isRead&&!this.props.inFullPage)return null;var e;_.isFunction(this.beforeMessage)&&(e=this.beforeMessage());var t;_.isFunction(this.markAsReadLink)&&(t=this.markAsReadLink());if(this.props.inDropdown){var n="clearfix",r="notificationsDropdown-description";this.props.notificationType==="product_update"&&(n+=" notificationsDropdown-typeUpdate bg-soft");var i=_.isFunction(this.hasManyLinks)&&this.hasManyLinks();i?r+="notificationsDropdown-oneLink-clear":n+=" notificationsDropdown-oneLink";var s=React.createElement("div",{className:"notificationsDropdown-wrapper"},e,React.createElement("span",{className:r},this.message()),React.createElement("span",{className:"notificationsDropdown-meta"},this.relativeCreatedAt()));return i?React.createElement("li",{className:n,onClick:this.goToLink},s,t):React.createElement("li",{className:n},React.createElement("a",{href:this.props.link,onClick:this.goToLink},s),t)}if(!this.props.inFullPage)return React.createElement("div",{className:"list-listItem is-unread ptb-s position-relative"},React.createElement("div",{className:"notificationsDropdown-notification pl-xxl"},e,t,React.createElement("div",{className:"notificationsDropdown-message mb-0 pl-5 pr-l fs-xs lh-xxs"},this.message(),this.relativeCreatedAt())));var n="list-listItem";return this.props.isRead||(n+=" is-unread"),React.createElement("li",{className:n},React.createElement("div",{className:"notificationsDropdown-notification"},React.createElement("div",{className:"u-pam u-clearfix"},e,React.createElement("div",{className:"notificationsDropdown-message"},this.message()),this.relativeCreatedAt())),t)},relativeCreatedAt:function(){var e=moment(this.props.createdAt).fromNow();if(!this.props.inDropdown&&!this.props.inFullPage)return React.createElement("div",{className:"notificationsDropdown-metadata fs-xxs lh-xxxs"},React.createElement("time",{dateTime:this.props.createdAt},e));var t,n;return _.isFunction(this.topMetadata)&&(t=this.topMetadata()),_.isFunction(this.bottomMetadata)&&(n=this.bottomMetadata()),React.createElement("p",{className:"notificationsDropdown-metadata"},t," ",React.createElement("time",{dateTime:this.props.createdAt},e)," ",n)},notificationImageBlock:function(){var e="s-icon s-icon-close notificationsDropdown-alert",t="";return _.isFunction(this.isSpaceInvitation)&&(e+=" alertSpace",t=""),React.createElement("span",{"aria-hidden":"true","data-icon":t,className:e})},setHeight:function(t){if(!this.props.inDropdown)return;var n=e(ReactDOM.findDOMNode(this));n.css("opacity",.5),setTimeout(function(){n.css("height",0)},2e3)}}}(jQuery),function(e){"use strict";var t=e.NotificationCenterNamespace;t.ProductUpdateMixin={processSuccess:function(e){this.props.onMarkProductUpdateAsRead(this.props.id)},processFailure:function(){this.errorMessage("Failed to mark product update as read")},markAsRead:function(n){e.helpers.handleEvent(n),t.NotificationCenterManager.markProductUpdateAsRead(this.props.id).done(this.processSuccess).fail(this.processFailure)}}}(jQuery),function(e){"use strict";var t=e.NotificationCenterNamespace;t.UserNotificationMixin={getInitialState:function(){return{isRead:!1}},processSuccess:function(t){var n=e(ReactDOM.findDOMNode(this));n.css("height",0),setTimeout(function(){this.isMounted()&&this.setState({isRead:!0}),this.props.onMarkNotificationAsRead(this.props.id)}.bind(this),1e3)},processFailure:function(){this.errorMessage("Failed to mark alert as read")},markAsRead:function(n){e.helpers.handleEvent(n),t.NotificationCenterManager.markNotificationAsRead(this.props.id).done(this.processSuccess).fail(this.processFailure)}}}(jQuery);var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};(function(e){"use strict";var t=e.NotificationCenterNamespace,n=e.commonComponents;t.Mentions.Container=React.createClass({displayName:"Container",mixins:[n.NotificationMessage,t.MentionsContainerMixin],propTypes:{inDropdown:React.PropTypes.bool.isRequired,inFullPage:React.PropTypes.bool.isRequired,mentions:React.PropTypes.arrayOf(React.PropTypes.app.Mention).isRequired,mentionsCount:React.PropTypes.number.isRequired,onMarkMentionsAsRead:React.PropTypes.func.isRequired,onMarkMentionAsRead:React.PropTypes.func.isRequired},markAllLink:function(){return this.props.mentionsCount===0?null:React.createElement("a",{className:"mark-all-link cta small color-gray inline",href:"javascript: void(0);",onClick:this.markAllMentionsAsRead},"Clear all")},mentionsList:function(){var e=this;return this.props.mentions.map(function(n){var r={id:n.id,author:n.author,link:n.link,event:n.event,text:n.text,createdAt:n.created_at,isRead:n.is_read};return React.createElement(t.Mentions.Mention,_extends({key:n.id,onMarkMentionAsRead:e.props.onMarkMentionAsRead,inDropdown:e.props.inDropdown,inFullPage:e.props.inFullPage},r))})},render:function(){return this.props.inDropdown?React.createElement("div",null,React.createElement("div",{className:"dropdown-header"},"You have ",React.createElement("span",{className:"counter"},this.props.mentionsCount)," mentions",React.createElement("div",{className:"o-floatR"},React.createElement("a",{className:"no-wrap o-floatL",href:t.NotificationCenterManager.mentionsUrl()},"View all mentions"),this.markAllLink())),React.createElement("ul",{className:"list list--dividers"},this.mentionsList())):this.props.inFullPage?React.createElement("ul",{className:"clearfix list list--dividers"},this.mentionsList()):React.createElement("div",{className:"pt-5"},this.mentionsList())}})})(jQuery),function(e){"use strict";var t=e.NotificationCenterNamespace,n=e.commonComponents;t.Mentions.Mention=React.createClass({displayName:"Mention",mixins:[t.MentionMixin,t.NotificationMixin,n.MouseButtonsMixin,n.NotificationMixin],propTypes:{inDropdown:React.PropTypes.bool.isRequired,inFullPage:React.PropTypes.bool.isRequired,id:React.PropTypes.number.isRequired,author:React.PropTypes.shape({avatar_url:React.PropTypes.string.isRequired,name:React.PropTypes.string.isRequired}),link:React.PropTypes.string.isRequired,event:React.PropTypes.shape({icon_class:React.PropTypes.string,pretty_name:React.PropTypes.string,space_name:React.PropTypes.string}),text:React.PropTypes.string.isRequired,createdAt:React.PropTypes.string.isRequired,isRead:React.PropTypes.bool},getInitialState:function(){return{isRead:this.props.isRead}},authorName:function(){return _.isDefined(this.props.author)&&!_.isNull(this.props.author)?this.props.author.name:React.createElement("em",null,"deleted user")},eventData:function(){if(!this.props.event)return null;var e="s-icon s-icon-"+this.props.event.icon_class,t=this.props.inDropdown?"o-fontWeight500":"fw-6";return React.createElement("span",{className:t},React.createElement("span",{className:e})," ",this.props.event.pretty_name)},beforeMessage:function(){return this.props.author?this.props.inDropdown?React.createElement("img",{alt:"User picture",className:"notificationsDropdown-image",width:"56",height:"56",src:this.props.author.avatar_url}):this.props.inFullPage?React.createElement(n.UserPictureLink,{user:this.props.author,displayName:!1,className:"notificationsDropdown-avatar"}):React.createElement("img",{alt:"User picture",className:"br-s u-pinTL ml-s mt-2",src:this.props.author.avatar_url}):null},message:function(){return this.props.inDropdown?React.createElement("div",null,React.createElement("span",{className:"o-fontWeight500"},this.authorName())," mentioned you on ",this.eventData()," - ",React.createElement("blockquote",{dangerouslySetInnerHTML:{__html:'"'+this.props.text+'"'}})):this.props.inFullPage?React.createElement("div",null,this.newLabel(),React.createElement("a",{href:this.props.link,onClick:this.setHeight},React.createElement("span",{className:"o-fontWeight500"},this.authorName())," mentioned you on ",this.eventData())," - ",React.createElement("blockquote",{dangerouslySetInnerHTML:{__html:'"'+this.props.text+'"'}})):React.createElement("a",{href:this.props.link,className:"display-inlineBlock mb-3 link--toLighter td-noneAll",onClick:this.setHeight},React.createElement("span",{className:"fw-6"},this.authorName())," mentioned you on ",this.eventData()," ",React.createElement("span",{className:"link--darkToLight",dangerouslySetInnerHTML:{__html:this.props.text}}))},markAsReadLink:function(){return this.props.isRead?null:this.markAsReadElement()},newLabel:function(){return!this.props.inFullPage||this.props.isRead?null:React.createElement("span",null,React.createElement("span",{className:"new-mention"},"New")," ")},bottomMetadata:function(){var e;return this.props.event&&this.props.event.space_name&&(e="in "+this.props.event.space_name),e},render:function(){return this.notificationWrapper()}})}(jQuery),function(e){"use strict";var t=e.NotificationCenterNamespace,n=e.commonComponents;t.NotificationCenterContainer=React.createClass({displayName:"NotificationCenterContainer",mixins:[n.NotificationMixin,n.DocumentClickListenerMixin,t.NotificationCenterDataFlowMixin,n.RealtimeReconnectable],propTypes:{mentionsCount:React.PropTypes.number.isRequired,notificationsCount:React.PropTypes.number.isRequired,productUpdatesCount:React.PropTypes.number.isRequired,isDropdown:React.PropTypes.bool.isRequired,forFullPage:React.PropTypes.bool.isRequired},getDefaultProps:function(){return{mentionsCount:0,productUpdatesCount:0,notificationsCount:0}},getInitialState:function(){return{page:1,lastPage:!0,visible:!this.props.isDropdown,mentionsCount:this.props.mentionsCount,notificationsCount:this.props.notificationsCount,productUpdatesCount:this.props.productUpdatesCount,mentions:[],productUpdates:[],notifications:[],mentionsLoaded:!1,productUpdatesLoaded:!1,notificationsLoaded:!1}},counterBlock:function(){return React.createElement(t.NotificationCenterCounter,{ref:"counter",notificationsCount:this.overallCount(),productUpdatesCount:this.state.productUpdatesCount,toggleNotificationCenter:this.toggleNotificationCenter})},markAllLink:function(){return this.overallCount()===0?null:React.createElement("a",{href:"javascript: void(0);",className:"right",onClick:this.markAllAsRead},"Mark all as read")},mentionsHowToBlock:function(){return React.createElement("span",null,"Create a mention by simply writing the team member ",React.createElement("strong",null,"@login")," in a ticket, a wiki, a stand up report, a message, commit message or a merge request and your team member will receive an alert with a link to it. You can also create a mention for your entire team by typing ",React.createElement("strong",null,"@team"),". If you want to send a mention to a specific group of users, you can add a label to them in the team page and write ",React.createElement("strong",null,"@label")," so that they receive a mention.")},notificationsList:function(){var e;if(this.overallCount()===0||!this.isDataLoaded())e=React.createElement("li",{className:"clearfix notificationsDropdown-zeroState"},"No new notifications");else{var t=_.sortBy(this.state.mentions.concat(this.state.productUpdates,this.state.notifications),function(e){return e.created_at}).reverse();e=t.map(this.createNotificationItem)}return React.createElement("ul",{className:"notificationsDropdown-list clearfix"},e)},mentionsBlock:function(){return React.createElement(t.Mentions.Container,{mentions:this.state.mentions,mentionsCount:this.state.mentionsCount,onMarkMentionsAsRead:this.markAllMentionsAsRead,onMarkMentionAsRead:this.markMentionAsRead,inDropdown:this.props.isDropdown,inFullPage:this.props.forFullPage})},render:function(){if(this.props.isDropdown){var e={};return this.state.visible&&(e={display:"block"}),React.createElement("div",null,this.counterBlock(),React.createElement("div",{className:"notificationsDropdown",style:e,ref:"dropdown"},React.createElement("div",{className:"triangle notification-triangle",ref:"triangle"}),React.createElement("div",{className:"notificationsDropdown-container"},React.createElement("div",{className:"notificationsDropdown-header clearfix"},React.createElement("a",{href:t.NotificationCenterManager.mentionsUrl()},"View all mentions"),React.createElement("a",{className:"notRecent",target:"_blank",href:t.NotificationCenterManager.productUpdatesUrl()},"View Product Updates & Roadmap"),this.markAllLink()),this.notificationsList())))}if(this.props.forFullPage){var n,r;return this.state.mentionsCount===0?n=React.createElement("p",{className:"no_mentions"},"You have no mentions"):n=React.createElement("div",{className:"notificationsDropdown-container"},this.mentionsBlock()),this.state.lastPage||(r=React.createElement("div",null,React.createElement("a",{href:"javascript: void(0);",className:"s-full align-center gray-btn",onClick:this.loadMoreMentions},"Show more"))),React.createElement("div",{className:"mentions-list-wrapper notification-stream no-border"},React.createElement("div",{className:"float-left"},React.createElement("h1",null,"My Mentions")),React.createElement("div",{className:"inline mt-2 ml-5"},React.createElement("a",{className:"mark-all-link gray-btn small",href:"javascript: void(0);",onClick:this.markAllMentionsAsRead},"Clear all")),React.createElement("div",{className:"clearfix"}," "),React.createElement("p",null,React.createElement("strong",null,"How does it work?")," ",this.mentionsHowToBlock()),n,r)}var i="link--white plr-8 br-m fw-6 fs-xs lh-s display-block ta-center";this.state.mentionsCount>0?i+=" bg-negative":i+=" bg-gray--2";var n;return this.state.mentionsCount>0?n=this.mentionsBlock():this.state.showMentionsInfo?n=React.createElement("p",{className:"p-20"},this.mentionsHowToBlock()," ",React.createElement("a",{href:t.NotificationCenterManager.mentionsUrl()},"View all my mentions")):n=React.createElement("div",{className:"p-20 mb-10"},React.createElement("a",{href:t.NotificationCenterManager.mentionsUrl(),className:"nowrap o-floatL link--light"},"View all mentions")),React.createElement("div",null,React.createElement("div",{className:"u-cf pb-s mb-s"},React.createElement("div",null,React.createElement("div",{className:"float-left"},React.createElement("span",{className:"iconSize--m ml-xs va-middle","aria-hidden":"true","data-icon":""}),React.createElement("span",{className:"lh-m ml-s fs-m fw-6 va-middle"},React.createElement("a",{className:"link--dark",href:t.NotificationCenterManager.mentionsUrl()},"Mentions"))),React.createElement("div",{className:"float-right lh-xxs position-relative mt-2"},React.createElement("a",{href:t.NotificationCenterManager.mentionsUrl(),className:i},this.state.mentionsCount)))),React.createElement("div",null,n))}})}(jQuery),function(e){"use strict";var t=e.NotificationCenterNamespace;t.NotificationCenterCounter=React.createClass({displayName:"NotificationCenterCounter",propTypes:{notificationsCount:React.PropTypes.number.isRequired,productUpdatesCount:React.PropTypes.number.isRequired,toggleNotificationCenter:React.PropTypes.func.isRequired},toggleNotificationCenter:function(t){e.helpers.handleEvent(t),this.props.toggleNotificationCenter()},componentDidUpdate:function(t,n){if(this.props.notificationsCount!==t.notificationsCount){var r=e(this.refs.counter);r.removeClass("u-mention--hl"),setTimeout(function(){r.addClass("u-mention--hl")},500)}},render:function(){var e="notifications-count",t;return this.props.notificationsCount>0&&(e+=" notifications-red u-mention--hl"),this.props.productUpdatesCount>0&&(t=React.createElement("div",{className:"product-notification-dot"}),e+=" product-notification-badge"),React.createElement("div",{className:"nav-user-notification-area"},React.createElement("div",{className:"nav-notification-badge"},React.createElement("a",{href:"javascript: void(0);",ref:"counter",onClick:this.toggleNotificationCenter,className:e},this.props.notificationsCount),t))}})}(jQuery),function(e){"use strict";var t=e.NotificationCenterNamespace,n=e.commonComponents;t.Notifications.Invitation=React.createClass({displayName:"Invitation",mixins:[n.NotificationMixin,t.NotificationMixin,t.UserNotificationMixin,n.MouseButtonsMixin],propTypes:{id:React.PropTypes.number.isRequired,spaceWikiName:React.PropTypes.string.isRequired,spaceLink:React.PropTypes.string.isRequired,confirmationUrl:React.PropTypes.string.isRequired,declinationUrl:React.PropTypes.string.isRequired,inviterLogin:React.PropTypes.string,inviterUrl:React.PropTypes.string,createdAt:React.PropTypes.string.isRequired},hasManyLinks:function(){return!0},isSpaceInvitation:function(){return!0},topMetadata:function(){return this.props.inviterLogin?React.createElement("a",{href:this.props.inviterUrl,rel:"fancybox"},this.props.inviterLogin):React.createElement("em",null,"deleted user")},beforeMessage:function(){return React.createElement("span",{"aria-hidden":"true","data-icon":"",className:"s-icon s-icon-close notificationsDropdown-alert alertSpace"})},message:function(){return React.createElement("div",null,"You have been invited to ",React.createElement("a",{href:this.props.spaceLink},this.props.spaceWikiName),". ",React.createElement("blockquote",null,"Click to ",React.createElement("a",{href:this.props.confirmationUrl},"accept")," or ",React.createElement("a",{href:this.props.declinationUrl},"reject")," invitation."))},render:function(){return this.notificationWrapper()}})}(jQuery),function(e){"use strict";var t=e.NotificationCenterNamespace;t.Notifications.Notification=React.createClass({displayName:"Notification",propTypes:{type:React.PropTypes.string.isRequired,data:React.PropTypes.object.isRequired,inDropdown:React.PropTypes.bool.isRequired,onMarkNotificationAsRead:React.PropTypes.func.isRequired},notificationImageBlock:function(){return React.createElement("span",{"aria-hidden":"true","data-icon":"",className:"s-icon s-icon-close notificationsDropdown-alert"})},render:function(){var n=e.extend({},this.props.data,{onMarkNotificationAsRead:this.props.onMarkNotificationAsRead,inDropdown:this.props.inDropdown,beforeMessage:this.notificationImageBlock});switch(this.props.type){case"plan_subscription_transfer_request":return React.createElement(t.Notifications.PlanSubscriptionTransferRequest,n);case"invitation":return React.createElement(t.Notifications.Invitation,n);case"reminder":return React.createElement(t.Notifications.Reminder,n)}}})}(jQuery),function(e){"use strict";var t=e.NotificationCenterNamespace,n=e.commonComponents;t.Notifications.PlanSubscriptionTransferRequest=React.createClass({displayName:"PlanSubscriptionTransferRequest",mixins:[n.NotificationMixin,t.NotificationMixin,t.UserNotificationMixin,n.MouseButtonsMixin],propTypes:{id:React.PropTypes.number.isRequired,requesterLogin:React.PropTypes.string.isRequired,requesterProfileUrl:React.PropTypes.string.isRequired,acceptUrl:React.PropTypes.string.isRequired,rejectUrl:React.PropTypes.string.isRequired,createdAt:React.PropTypes.string.isRequired,beforeMessage:React.PropTypes.func},hasManyLinks:function(){return!0},beforeMessage:function(){return this.props.beforeMessage()},topMetadata:function(){return React.createElement("a",{href:this.props.requesterProfileUrl,rel:"fancybox",title:this.props.requesterLogin},this.props.requesterLogin)},message:function(){return React.createElement("div",null,"You have been asked to become payer for ",this.props.requesterLogin," subscription. ",React.createElement("blockquote",null,"Click to ",React.createElement("a",{href:this.props.acceptUrl},"accept")," or ",React.createElement("a",{href:this.props.rejectUrl},"reject")," request."))},render:function(){return this.notificationWrapper()}})}(jQuery),function(e){"use strict";var t=e.NotificationCenterNamespace,n=e.commonComponents;t.Notifications.Reminder=React.createClass({displayName:"Reminder",mixins:[n.NotificationMixin,t.NotificationMixin,t.UserNotificationMixin,n.MouseButtonsMixin],propTypes:{id:React.PropTypes.number.isRequired,text:React.PropTypes.string.isRequired,spaceName:React.PropTypes.string,link:React.PropTypes.string.isRequired,createdAt:React.PropTypes.string.isRequired,markableAsRead:React.PropTypes.bool.isRequired,onMarkNotificationAsRead:React.PropTypes.func.isRequired,beforeMessage:React.PropTypes.func},markAsReadLink:function(){return this.props.markableAsRead?this.markAsReadElement():null},bottomMetadata:function(){return this.props.spaceName?React.createElement("span",null,"in ",React.createElement("span",{className:"o-fontWeight700"},this.props.spaceName)):null},beforeMessage:function(){return this.props.beforeMessage()},message:function(){return React.createElement("span",{className:"notificationsDropdown-title"},this.props.text)},render:function(){return this.notificationWrapper()}})}(jQuery),function(e){"use strict";var t=e.NotificationCenterNamespace,n=e.commonComponents;t.ProductUpdates.ProductUpdate=React.createClass({displayName:"ProductUpdate",mixins:[t.NotificationMixin,t.ProductUpdateMixin,n.NotificationMixin,n.MouseButtonsMixin],propTypes:{id:React.PropTypes.number.isRequired,inDropdown:React.PropTypes.bool.isRequired,title:React.PropTypes.string.isRequired,link:React.PropTypes.string,createdAt:React.PropTypes.string.isRequired,imageUrl:React.PropTypes.string.isRequired},getInitialState:function(){return{isRead:!1}},beforeMessage:function(){return React.createElement("img",{className:"notificationsDropdown-image",alt:"Assembla",src:this.props.imageUrl})},message:function(){return this.props.title},markAsReadLink:function(){return React.createElement("a",{href:"javascript: void(0);",onClick:this.markAsRead,title:"Mark as read",className:"notificationsDropdown-readToggle","aria-hidden":"true"})},render:function(){return this.notificationWrapper()}})}(jQuery),function(e){"use strict";function o(){return r=r||JSON.parse(e("#notification-center-setup").text()),r}function u(e){return o().urls[e]}function a(){return u("mentions").all}function f(){return u("mentions").mark_all_as_read}function l(e){var t=u("mentions").mark_as_read;return t.replace(":id",e)}function c(){return u("product_updates").all}function h(){return u("product_updates").load}function p(){return u("product_updates").mark_all_as_read}function d(e){var t=u("product_updates").mark_as_read;return t.replace(":id",e)}function v(){return u("notifications").all}function m(){return u("notifications").mark_all_as_read}function g(e){var t=u("notifications").mark_as_read;return t.replace(":id",e)}function y(t){return t=t||{},e.extend({errorHandler:n},t)}function b(e){return e=e||{},e.data=e.data||{},e.data.fnh="1",y(e)}var t=window.Breakout,n,r,i=e.helpers,s=window.NotificationCenterManager=function(e){n=e.errorHandler};s.prototype={loadMentions:function(t){return i.restRequest(a(),"get",b({data:t}))},markAllMentionsAsRead:function(){return e.helpers.restRequest(f(),"put",y())},markMentionAsRead:function(n){return e.helpers.restRequest(l(n),"put",y())},loadProductUpdates:function(){return i.restRequest(h(),"get",b())},markAllProductUpdatesAsRead:function(){return e.helpers.restRequest(p(),"put",y())},markProductUpdateAsRead:function(n){return e.helpers.restRequest(d(n),"put",y())},loadNotifications:function(){return i.restRequest(v(),"get",b())},markAllNotificationsAsRead:function(){return e.helpers.restRequest(m(),"put",y())},markNotificationAsRead:function(n){return e.helpers.restRequest(g(n),"put",y())},mentionsUrl:a,productUpdatesUrl:c}}(jQuery),function(e){"use strict";var t=RealTime.Manager();window.NotificationCenterChannelActions=function(e){var n=function(e){return e.notification_center},r={"mention-added":function(e){this.addMention(e.mention,e.count)},"mention-updated":function(e){this.updateMention(e.mention,e.count)},"mention-removed":function(e){setTimeout(function(){this.markMentionAsRead(e.id,e.new_mention,e.count)}.bind(this),2e3)},"notification-added":function(e){this.addNotification(e.notification,e.count)},"notification-removed":function(e){this.markNotificationAsRead(e.id,e.new_notification,e.count)},"announcement-removed":function(e){this.markProductUpdateAsRead(e.id,e.count)}},i={subscribe:function(e,i){_.each(e,function(e){var s=r[e].bind(i);t.subscribe(n,e,s)}.bind(this))},unsubscribe:function(){t.unsubscribe(n)}},s=[];return _.each(_.keys(r),function(e){var t=e.toUpperCase().replace(/-/g,"_");i[t]=e,s.push(e)}),i.ALL=s,i}}(jQuery),function(e){"use strict";function r(){t.NotificationCenterManager=new NotificationCenterManager({errorHandler:n.errorHandler}),t.NotificationCenterChannelActions=new NotificationCenterChannelActions(t.NotificationCenterManager),i(),s(),o()}function i(){var r=e("#notificationCenterContainer");if(r.length===0)return;n.renderReactElement(t.NotificationCenterContainer,{isDropdown:!0,forFullPage:!1},r.attr("id"))}function s(){var r=e('[id^="mentionsContainer"]');if(r.length===0)return;
e.each(r,function(r,i){n.renderReactElement(t.NotificationCenterContainer,{isDropdown:!1,forFullPage:!1},e(i).attr("id"))})}function o(){var r=e("#mentionsListContainer");if(r.length===0)return;n.renderReactElement(t.NotificationCenterContainer,{isDropdown:!1,forFullPage:!0},r.attr("id"))}var t=e.NotificationCenterNamespace,n=e.helpers;t.init=r,e(document).ready(function(){t.init()})}(jQuery),window.jQuery=window.jQueryOld;